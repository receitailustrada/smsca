<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>APS / ESF • Workspace</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  :root{
    /* Paleta Behance-like: Alto contraste, fundo limpo */
    --bg: #F9FAFB;
    --surface: #FFFFFF;
    --text-main: #111111;
    --text-sub: #767676;
    
    --accent: #0057FF; /* Azul elétrico para destaque */
    
    /* Sombras suaves e profundas */
    --shadow-card: 0 10px 30px -10px rgba(0,0,0,0.08);
    --shadow-hover: 0 20px 40px -10px rgba(0,0,0,0.15);
    
    --radius: 16px; /* Cantos bem arredondados */
    --trans: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); /* Animação fluida */
  }

  *{box-sizing:border-box}
  
  body{
    margin:0;
    background:var(--bg);
    color:var(--text-main);
    font-family: 'Outfit', sans-serif;
    -webkit-font-smoothing: antialiased;
    padding-bottom: 100px; /* Espaço para o footer flutuante */
  }

  .container{
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 24px;
  }

  /* --- Header --- */
  .header{
    margin-bottom: 48px;
    animation: fadeUp 0.6s ease-out;
  }
  
  .brand{
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 8px;
    display: block;
  }

  .title{
    font-size: 42px;
    font-weight: 700;
    margin: 0;
    line-height: 1.1;
    letter-spacing: -1px;
  }
  
  .subtitle{
    font-size: 18px;
    color: var(--text-sub);
    margin-top: 12px;
    font-weight: 400;
    max-width: 600px;
  }

  /* --- Controles (Search + Filter) --- */
  .toolbar{
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 32px;
    align-items: center;
  }

  .search-wrap{
    background: var(--surface);
    border-radius: 50px;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.04);
    flex: 1 1 300px;
    transition: var(--trans);
    border: 1px solid transparent;
  }
  .search-wrap:focus-within{
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    transform: translateY(-1px);
    border-color: rgba(0,0,0,0.1);
  }
  .search-wrap svg{ width: 20px; color: var(--text-sub); }
  .search-wrap input{
    border: none;
    outline: none;
    font-family: inherit;
    font-size: 16px;
    width: 100%;
    color: var(--text-main);
  }

  .filter-group{
    display: flex;
    gap: 8px;
    background: #EFEFEF;
    padding: 4px;
    border-radius: 50px;
  }
  
  .filter-btn{
    border: none;
    background: transparent;
    padding: 10px 20px;
    border-radius: 40px;
    font-family: inherit;
    font-weight: 500;
    font-size: 14px;
    color: var(--text-sub);
    cursor: pointer;
    transition: var(--trans);
  }
  .filter-btn:hover{ color: var(--text-main); }
  .filter-btn[aria-pressed="true"]{
    background: var(--surface);
    color: var(--text-main);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  /* --- GRID --- */
  .grid-title{
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--text-sub);
    margin: 40px 0 20px 0;
    letter-spacing: 0.5px;
    padding-left: 4px;
  }

  .grid{
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 24px;
  }

  /* --- CARD (Behance Style) --- */
  .card{
    background: var(--surface);
    border-radius: var(--radius);
    overflow: hidden;
    cursor: pointer;
    position: relative;
    box-shadow: var(--shadow-card);
    transition: var(--trans);
    opacity: 0; 
    animation: fadeUp 0.6s forwards; /* Entrada suave */
  }

  .card:hover{
    transform: translateY(-8px);
    box-shadow: var(--shadow-hover);
  }

  /* Imagem com container para zoom */
  .card-img-wrap{
    height: 180px;
    overflow: hidden;
    position: relative;
    background: #f0f0f0;
  }
  
  .card-img-wrap img{
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
    opacity: 0; /* Fade in no load */
  }
  .card-img-wrap img.loaded{ opacity: 1; }
  
  /* Zoom effect */
  .card:hover .card-img-wrap img{
    transform: scale(1.08);
  }

  /* Tratamento especial para logos (municípios) */
  .card.is-mun .card-img-wrap img{
    object-fit: contain;
    padding: 24px;
  }

  .card-body{
    padding: 20px;
  }

  .card-title{
    font-size: 18px;
    font-weight: 700;
    margin: 0 0 4px 0;
    color: var(--text-main);
  }
  .card-sub{
    font-size: 14px;
    color: var(--text-sub);
    margin: 0;
  }

  /* Estado Selecionado */
  .card[aria-selected="true"]{
    box-shadow: 0 0 0 2px var(--accent), var(--shadow-hover);
  }
  .card[aria-selected="true"] .card-title{
    color: var(--accent);
  }

  /* --- Footer (Floating Glass) --- */
  .dock{
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%) translateY(120%); /* Escondido */
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    padding: 12px 24px;
    border-radius: 60px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    gap: 24px;
    z-index: 100;
    transition: var(--trans);
    border: 1px solid rgba(255,255,255,0.5);
    width: 90%;
    max-width: 600px;
  }
  
  .dock.visible{
    transform: translateX(-50%) translateY(0);
  }

  .dock-info{
    flex: 1;
    font-size: 14px;
    color: var(--text-main);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .dock-info strong{ color: var(--accent); }

  .dock-actions{ display: flex; gap: 8px; }

  .btn{
    border: none;
    padding: 12px 24px;
    border-radius: 40px;
    font-weight: 700;
    cursor: pointer;
    font-size: 14px;
    transition: var(--trans);
  }
  .btn-primary{
    background: var(--text-main);
    color: #fff;
  }
  .btn-primary:hover{
    background: var(--accent);
    transform: scale(1.05);
  }
  .btn-ghost{
    background: transparent;
    color: var(--text-sub);
  }
  .btn-ghost:hover{ color: var(--text-main); }

  @keyframes fadeUp {
    from{ opacity: 0; transform: translateY(20px); }
    to{ opacity: 1; transform: translateY(0); }
  }
  
  /* Fallback SVG */
  .fallback-svg{ background: #f0f0f0; width: 100%; height: 100%; display:flex; align-items:center; justify-content:center; font-weight:700; color:#ccc; font-size:32px; }
  
  /* Ajuste Mobile */
  @media(max-width: 600px){
    .title{ font-size: 32px; }
    .toolbar{ flex-direction: column; align-items: stretch; }
    .search-wrap{ flex: auto; }
    .filter-group{ justify-content: space-between; }
    .dock{ bottom: 16px; flex-direction: column; gap: 12px; border-radius: 24px; padding: 16px; }
    .dock-actions{ width: 100%; }
    .btn{ flex: 1; }
  }
</style>
</head>

<body>

<div class="container">
  
  <header class="header">
    <span class="brand">Ecossistema APS • Cruz Alta</span>
    <h1 class="title">Onde você vai<br>trabalhar hoje?</h1>
    <p class="subtitle">Selecione sua unidade ou serviço para configurar o ambiente.</p>

    <div class="toolbar">
      <div class="search-wrap">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
        <input type="text" id="q" placeholder="Buscar unidade, serviço ou cidade...">
      </div>

      <div class="filter-group">
        <button class="filter-btn" data-filter="all" aria-pressed="true">Todos</button>
        <button class="filter-btn" data-filter="esf" aria-pressed="false">ESFs</button>
        <button class="filter-btn" data-filter="serv" aria-pressed="false">Serviços</button>
        <button class="filter-btn" data-filter="mun" aria-pressed="false">Municípios</button>
      </div>
    </div>
  </header>

  <main id="main">
    </main>

</div>

<div class="dock" id="dock">
  <div class="dock-info" id="dock-info">Selecione um local</div>
  <div class="dock-actions">
    <button class="btn btn-ghost" id="clear">Cancelar</button>
    <button class="btn btn-primary" id="confirm">Confirmar Acesso</button>
  </div>
</div>

<script>
  // Utils
  const el = (s) => document.querySelector(s);
  const els = (s) => Array.from(document.querySelectorAll(s));
  const norm = (s) => (s||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase();
  const slug = (s) => norm(s).replace(/[^a-z0-9]/g,"-");

  // Dados
  const GH_BASE = "https://raw.githubusercontent.com/receitailustrada/smsca/refs/heads/main/";
  const brasao = (n) => GH_BASE + "rxi-brasao-" + slug(n) + "-512.png";
  
  // Lista Unificada
  const DATA = [
    // ESFs
    { id:"esf-tv", k:"esf", n:"Toríbio Veríssimo", s:"ESF I", i: GH_BASE+"esf--I-tv.png" },
    { id:"esf-ab", k:"esf", n:"Abegai", s:"ESF II", i: GH_BASE+"esf--ii--ab.png" },
    { id:"esf-al", k:"esf", n:"Alvorada", s:"ESF III", i: GH_BASE+"esf--III-alvorada.png" },
    { id:"esf-dn", k:"esf", n:"DNER", s:"ESF IV", i: GH_BASE+"esf--IV-dner.png" },
    { id:"esf-sr", k:"esf", n:"Santa Rita", s:"ESF V", i: GH_BASE+"esf--v-sr.png" },
    { id:"esf-st", k:"esf", n:"Santa Terezinha II", s:"ESF VI", i: GH_BASE+"ESF--VI-Santa-Terezinha-II.png" },
    { id:"esf-br", k:"esf", n:"Brum", s:"ESF VII", i: GH_BASE+"ESF-VI-Bairro-Brum-I.png" },
    { id:"esf-sj", k:"esf", n:"São José", s:"ESF VIII", i: GH_BASE+"esf--VIII-bsj.png" },
    { id:"esf-jp", k:"esf", n:"Jardim Primavera", s:"ESF IX", i: GH_BASE+"esf--IX-bjp.png" },
    { id:"esf-vn", k:"esf", n:"Vila Nova", s:"ESF X", i: GH_BASE+"smsca-esf-x-vila-nova-nk-hc.png" },
    { id:"esf-pe", k:"esf", n:"Penha", s:"ESF XI", i: GH_BASE+"ESF---XI-penha.png" },
    { id:"esf-sg", k:"esf", n:"São Genaro", s:"ESF XII", i: GH_BASE+"esf--xii-sg.png" },
    { id:"esf-pr", k:"esf", n:"Progresso", s:"ESF XIII", i: GH_BASE+"esf--XIII-bp.png" },
    { id:"esf-af", k:"esf", n:"Acelino Flores", s:"ESF XIV", i: GH_BASE+"esf--xiv-af.png" },
    { id:"esf-ft", k:"esf", n:"Fátima", s:"ESF XV", i: GH_BASE+"esf-xv-fatima.png" },
    { id:"esf-lz", k:"esf", n:"Lizabel", s:"ESF XVI", i: GH_BASE+"esf--XVI-lz.png" },
    { id:"esf-vr", k:"esf", n:"Vila Rocha", s:"ESF XVIII", i: GH_BASE+"esf-vila-rocha.png" },
    { id:"esf-ct", k:"esf", n:"Centro", s:"ESF XIX", i: GH_BASE+"esf--XIX-centro.png" },
    { id:"esf-bp", k:"esf", n:"Boa Parada", s:"ESF XX", i: GH_BASE+"esf---boaparada.png" },
    { id:"esf-bo", k:"esf", n:"Bonini", s:"ESF XXI", i: GH_BASE+"esf--xxi-bonini.png" },
    { id:"esf-vd", k:"esf", n:"Vida Nova", s:"EAP NOVA", i: GH_BASE+"ESF-vida-nova-1280.png" },
    { id:"eap-bn", k:"esf", n:"Benjamin Nott", s:"EAP Rural", i: GH_BASE+"eap-bn.png" },
    
    // Serviços (Usei letras como fallback se imagem falhar, mas deixei preparado)
    { id:"srv-60", k:"serv", n:"Saúde 60+ RS", s:"Programa", i: null },
    { id:"srv-sm", k:"serv", n:"SER Mulher", s:"Programa", i: null },
    { id:"srv-cm", k:"serv", n:"CEM", s:"Especialidades", i: null },
    { id:"srv-fs", k:"serv", n:"FISIO", s:"Reabilitação", i: null },
    { id:"srv-ss", k:"serv", n:"SMS", s:"Secretaria", i: null },
    { id:"srv-9c", k:"serv", n:"9ª CRS", s:"Coordenadoria", i: null },
    { id:"srv-up", k:"serv", n:"UPA 24h", s:"Urgência", i: null },
    { id:"srv-hs", k:"serv", n:"Hosp. São Vicente", s:"Hospital", i: null },
    { id:"srv-hl", k:"serv", n:"Hosp. Santa Lúcia", s:"Hospital", i: null },
    { id:"srv-cp", k:"serv", n:"CAPS", s:"Saúde Mental", i: null },

    // Municípios
    { id:"mun-bv", k:"mun", n:"Boa Vista do Cadeado", s:"Município", i: brasao("Boa Vista do Cadeado") },
    { id:"mun-bi", k:"mun", n:"Boa Vista do Incra", s:"Município", i: brasao("Boa Vista do Incra") },
    { id:"mun-ca", k:"mun", n:"Cruz Alta", s:"Município", i: brasao("Cruz Alta") },
    { id:"mun-fv", k:"mun", n:"Fortaleza dos Valos", s:"Município", i: brasao("Fortaleza dos Valos") },
    { id:"mun-ib", k:"mun", n:"Ibirubá", s:"Município", i: brasao("Ibirubá") },
    { id:"mun-jc", k:"mun", n:"Jacuizinho", s:"Município", i: brasao("Jacuizinho") },
    { id:"mun-jr", k:"mun", n:"Jari", s:"Município", i: brasao("Jari") },
    { id:"mun-pj", k:"mun", n:"Pejuçara", s:"Município", i: brasao("Pejuçara") },
    { id:"mun-qn", k:"mun", n:"Quinze de Novembro", s:"Município", i: brasao("Quinze de Novembro") },
    { id:"mun-sj", k:"mun", n:"Salto do Jacuí", s:"Município", i: brasao("Salto do Jacuí") },
    { id:"mun-tp", k:"mun", n:"Tupanciretã", s:"Município", i: brasao("Tupanciretã") },
    { id:"mun-sm", k:"mun", n:"Santa Maria", s:"Município", i: brasao("Santa Maria") },
    { id:"mun-po", k:"mun", n:"Porto Alegre", s:"Município", i: brasao("Porto Alegre") },
  ];

  let state = { filter: 'all', q: '', selected: null };

  // Render Logic
  function render(){
    const main = el('#main');
    main.innerHTML = '';

    // Filtragem
    const items = DATA.filter(d => {
      const matchFilter = state.filter === 'all' || state.filter === d.k;
      const matchSearch = !state.q || norm(d.n + " " + d.s).includes(norm(state.q));
      return matchFilter && matchSearch;
    });

    // Agrupamento por Seção
    const groups = {
      esf: { title: "Unidades de Saúde", items: [] },
      serv: { title: "Serviços & Programas", items: [] },
      mun: { title: "Municípios (9ª CRS)", items: [] }
    };

    items.forEach(i => groups[i.k]?.items.push(i));

    // Gerar HTML
    Object.values(groups).forEach(g => {
      if(g.items.length === 0) return;
      
      const secTitle = document.createElement('div');
      secTitle.className = 'grid-title';
      secTitle.textContent = g.title;
      main.appendChild(secTitle);

      const grid = document.createElement('div');
      grid.className = 'grid';

      g.items.forEach((item, idx) => {
        const card = document.createElement('div');
        card.className = `card ${item.k === 'mun' ? 'is-mun' : ''}`;
        card.style.animationDelay = `${idx * 50}ms`; // Cascata
        card.onclick = () => select(item);
        
        // Verifica se é o selecionado
        if(state.selected && state.selected.id === item.id) {
          card.setAttribute('aria-selected', 'true');
        }

        // Imagem ou Fallback (Letra)
        let imgHtml = '';
        if(item.i){
          imgHtml = `<img src="${item.i}" alt="${item.n}" loading="lazy" onload="this.classList.add('loaded')" onerror="this.parentElement.innerHTML='<div class=\\'fallback-svg\\'>${item.n[0]}</div>'">`;
        } else {
          imgHtml = `<div class='fallback-svg'>${item.n[0]}</div>`;
        }

        card.innerHTML = `
          <div class="card-img-wrap">
            ${imgHtml}
          </div>
          <div class="card-body">
            <h3 class="card-title">${item.n}</h3>
            <p class="card-sub">${item.s}</p>
          </div>
        `;
        grid.appendChild(card);
      });
      main.appendChild(grid);
    });

    if(items.length === 0){
      main.innerHTML = `<div style="text-align:center; padding:60px; color:#999;">Nenhum resultado encontrado.</div>`;
    }
    
    updateDock();
  }

  function select(item){
    state.selected = item;
    render(); // Re-render para mostrar borda azul
  }

  function updateDock(){
    const dock = el('#dock');
    if(state.selected){
      dock.classList.add('visible');
      el('#dock-info').innerHTML = `Selecionado: <strong>${state.selected.n}</strong>`;
    } else {
      dock.classList.remove('visible');
    }
  }

  // Event Listeners
  el('#q').addEventListener('input', e => { state.q = e.target.value; render(); });

  els('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      els('.filter-btn').forEach(b => b.setAttribute('aria-pressed', 'false'));
      btn.setAttribute('aria-pressed', 'true');
      state.filter = btn.dataset.filter;
      render();
    });
  });

  el('#clear').addEventListener('click', () => {
    state.selected = null;
    render();
  });

 el('#confirm').addEventListener('click', () => {
    if(!state.selected) return;
    
    const payload = {
      ...state.selected,
      timestamp: new Date().toISOString()
    };
    
    // Animação de saída
    el('#dock').textContent = "Confirmado! Acessando..."; // Mudei o texto
    el('#dock').style.background = "#0057FF"; // Azul para confirmar
    el('#dock').style.color = "#fff";
    
    // Salva a escolha do usuário no navegador
    localStorage.setItem("RXI_CONTEXT", JSON.stringify(payload));
    
    setTimeout(() => {
        // --- AQUI ESTÁ A MUDANÇA MÁGICA ---
        // Redireciona para o arquivo do painel antigo
        window.location.href = "painel.html"; 
    }, 800);
  });

  // Init
  render();

</script>
</body>
</html>
